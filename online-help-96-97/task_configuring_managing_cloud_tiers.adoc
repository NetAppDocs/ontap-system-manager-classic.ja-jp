---
permalink: online-help-96-97/task_configuring_managing_cloud_tiers.html 
sidebar: sidebar 
keywords: configure, manage, cloud, tier, online, help, fabricpool, aggregate, storage, system, add, ssd, provision, storage, fabricpool, aggregate, manually, tiering, policy 
summary: データを複数の階層に格納すると、ストレージシステムの効率を高めることができます。ストレージ階層の管理には、 FabricPool 対応アグリゲートを使用します。クラウド階層には、アクセス頻度に基づいてデータが格納されます。 
---
= System Manager - ONTAP 9.7 以前を使用して、クラウド階層を設定および管理します
:allow-uri-read: 


クラウド階層の設定と管理には、 ONTAP System Manger クラシック（ ONTAP 9.7 以前で利用可能）を使用できます。データを複数の階層に格納すると、ストレージシステムの効率を高めることができます。ストレージ階層の管理には、 FabricPool 対応アグリゲートを使用します。クラウド階層には、アクセス頻度に基づいてデータが格納されます。

.作業を開始する前に
* ONTAP 9.2 以降が実行されている必要があります。
* オールフラッシュ（オール SSD ）アグリゲートが必要です


image::../media/fabricpool_workflow.gif[FabricPool ワークフロー]



= クラウド階層を追加します

[role="lead"]
System Manager を使用して、 SSD アグリゲートまたは仮想マシンディスク（ VMDK ）アグリゲートにクラウド階層を追加できます。クラウド階層は、使用頻度の低いデータ用のストレージとして利用できます。

.作業を開始する前に
* オブジェクトストアに接続するためのアクセスキー ID とシークレットキーが必要です。
* オブジェクトストアにバケットを作成しておく必要があります。
* クラスタとクラウド階層の間でネットワーク接続が確立されている必要があります。
* クラウド階層とクラスタ間の通信が SSL または TLS を使用して暗号化されている場合は、必要な証明書をインストールする必要があります。


.このタスクについて
次のオブジェクトストアをクラウド階層として使用できます。

* StorageGRID
* Alibaba Cloud （ System Manager 9.6 以降）
* Amazon Web Services （ AWS ） Simple Storage Service （ S3 ）
* Amazon Web Services （ AWS ） Commercial Cloud Service （ C2S ）
* Microsoft Azure Blob Storage
* IBM クラウド
* Google Cloud


[NOTE]
====
* オンプレミスの Azure サービスである Azure Stack はサポートされていません。
* StorageGRID 以外のオブジェクトストアをクラウド階層として使用する場合は、 FabricPool 容量ライセンスが必要です。ライセンスを追加するには、 * ライセンスの追加 * をクリックします。
* IBM Cloud Object Storage 環境（ Cleversafe など）を FabricPool で使用する場合は、認証局（ CA ）証明書を指定する必要があります。CA 証明書を指定するには、 * Object Store Certificate * トグルボタンを移動し、証明書のクレデンシャルを指定します。


====
.手順
. [ * ストレージ * > * アグリゲートとディスク * > * クラウド階層 * ] をクリックします。
. [ 追加（ Add ） ] をクリックします。
+
ダイアログボックスにサポート対象のすべてのオブジェクトストアプロバイダが表示されます。

. クラウド階層として指定するオブジェクトストアプロバイダをリストから選択します。
+
クラウド階層の追加ウィンドウが表示されます。

. [*Region*] フィールドのドロップダウンリストからリージョンを選択します。
+
選択した内容に基づいて、 [ サービス名（ FQDN ） * ] フィールドにサーバエンドポイントが自動的に入力されます。

. クラウド階層のアクセスキー ID 、クラウド階層のシークレットキー、およびコンテナ名を指定します。
+
AWS Commercial Cloud Service （ C2S ）をタイプとして選択した場合は、 CAP URL 、サーバ CA 証明書、およびクライアント証明書を指定する必要があります。

. 次のいずれかの設定を変更する場合は、 [ 詳細オプション ] アイコンをクリックします image:../media/advanced_options.gif[""] [ 拡張オプション * ] ダイアログウィンドウを表示して、変更を行うことができます。
+
** クラウド階層へのアクセスに使用するポート番号
** クラウド階層へのデータのセキュアな転送を可能にする * SSL * オプションを有効または無効にします


. *オプション：* StorageGRID 用のクラウド階層を追加する場合や、IBM Cloud Object Storage環境（Cleversafeなど）をFabricPool で使用する場合は、CA証明書を指定する必要があります。「 * オブジェクトストア証明書 * 」トグルボタンを移動し、証明書の内容をコピーして、 CA 証明書を指定します。次に、署名済み証明書に証明書の内容を貼り付けます。
. IPspace * リストから、クラウド階層への接続に使用する IPspace を選択します。
. 保存 * をクリックしてクラウド階層を保存します。
. アグリゲートを保存して接続 * をクリックしてクラウド階層を保存し、クラウド階層にアグリゲートを接続します。




== アグリゲートをクラウド階層に接続する

System Manager を使用して、オールフラッシュアグリゲートをクラウド階層に接続できます。使用頻度の低いデータをクラウド階層に格納することができます。

.作業を開始する前に
クラスタにクラウド階層を追加しておく必要があります。

.手順
. [ * ストレージ * > * アグリゲートとディスク * > * クラウド階層 * ] をクリックします。
. [* Used in aggregates * ] 列で、 [* Attach Aggregates * ] をクリックします。
+
アグリゲートの接続ウィンドウが表示されます。

. クラウド階層に接続するアグリゲートを選択します。
. [ 保存（ Save ） ] をクリックします。




== FabricPool 対応アグリゲートを手動で作成してストレージをプロビジョニングする

System Manager で FabricPool 対応アグリゲートを作成して、 SSD アグリゲートにクラウド階層を接続することができます。

.作業を開始する前に
* クラウド階層を作成し、 SSD アグリゲートが配置されたクラスタに接続しておく必要があります。
* オンプレミスのクラウド階層を作成しておく必要があります。
* クラウド階層とアグリゲートの間に専用のネットワーク接続が確立されている必要があります。


.このタスクについて
次のオブジェクトストアをクラウド階層として使用できます。

* StorageGRID
* Alibaba Cloud （ System Manager 9.6 以降）
* Amazon Web Services （ AWS ） Simple Storage Service （ S3 ）
* Amazon Web Services （ AWS ） Commercial Cloud Service （ C2S ）
* Microsoft Azure Blob Storage
* IBM クラウド
* Google Cloud


[NOTE]
====
* オンプレミスの Azure サービスである Azure Stack はサポートされていません。
* StorageGRID 以外のオブジェクトストアをクラウド階層として使用する場合は、 FabricPool 容量ライセンスが必要です。


====
.手順
. 次のいずれかの方法を使用して FabricPool 対応アグリゲートを作成します。
+
** [ * アプリケーションと階層 * > * ストレージ階層 * > * アグリゲートの追加 * ] をクリックします。
** [ * ストレージ * > * アグリゲートとディスク * > * アグリゲート * > * 作成 * ] をクリックします。


. アグリゲートを作成するには、 * アグリゲートを手動で作成 * オプションを有効にしてください。
. FabricPool 対応アグリゲートを作成します。
+
.. アグリゲート名、ディスクタイプ、およびアグリゲートに含めるディスクまたはパーティションの数を指定します。
+
[NOTE]
====
FabricPool 対応アグリゲートは、オールフラッシュ（オール SSD ）アグリゲートでのみサポートされます。

====
+
ディスクサイズが最大のディスクグループに対して、最小限のホットスペアのルールが適用されます。

.. *オプション：*アグリゲートのRAID構成を変更します。
+
... [ 変更（ Change ） ] をクリックします。
... RAID 構成の変更ダイアログボックスで、 RAID タイプと RAID グループサイズを指定します。
+
共有ディスクでは RAID タイプとして RAID-DP と RAID-TEC の 2 つがサポートされます。

... [ 保存（ Save ） ] をクリックします。




. 「 * FabricPool * 」チェックボックスを選択し、リストからクラウド階層を選択します。
. [ 作成（ Create ） ] をクリックします。




== ボリュームの階層化ポリシーを変更する

System Manager を使用して、ボリュームのデフォルトの階層化ポリシーを変更することで、ボリュームのデータが非アクティブになったときにクラウド階層に移動するかどうかを制御できます。

.手順
. [* ストレージ *>* ボリューム *] をクリックします。
. SVM * フィールドのドロップダウンメニューで、 * すべての SVM * を選択します。
. 階層化ポリシーを変更するボリュームを選択し、 * その他の操作 * > * 階層化ポリシーの変更 * をクリックします。
. 「 * 階層化ポリシー * 」リストから必要な階層化ポリシーを選択し、「 * 保存 * 」をクリックします。




== クラウド階層を編集します

System Manager を使用して、クラウド階層の設定情報を変更できます。編集可能な設定には、名前、完全修飾ドメイン名（ FQDN ）、ポート、アクセスキー ID 、シークレットキー、およびオブジェクトストアの証明書が含まれます。

.手順
. [ * ストレージ * > * アグリゲートとディスク * > * クラウド階層 * ] をクリックします。
. 編集するクラウド階層を選択し、 * 編集 * をクリックします。
. クラウド階層の編集 * ウィンドウで、クラウド階層名、 FQDN 、ポート、アクセスキー ID 、シークレットキー、 必要に応じて、オブジェクトストアの証明書を追加します。
+
AWS Commercial Cloud Service （ C2S ）クラウド階層を選択した場合は、サーバ CA 証明書とクライアント証明書を変更できます。

. [ 保存（ Save ） ] をクリックします。




== クラウド階層を削除します

System Manager を使用して、不要になったクラウド階層を削除できます。

.作業を開始する前に
クラウド階層に関連付けられている FabricPool 対応アグリゲートを削除しておく必要があります。

.手順
. [ * ストレージ * > * アグリゲートとディスク * > * クラウド階層 * ] をクリックします。
. 削除するクラウド階層を選択し、 * 削除 * をクリックします。




== クラウド階層および階層化ポリシーとは

クラウド階層は、アクセス頻度の低いデータ用のストレージとして利用できます。オールフラッシュ（オール SSD ）アグリゲートをクラウド階層に接続して、使用頻度の低いデータを格納できます。データをクラウド階層に移動するかどうかは、階層化ポリシーで制御できます。

ボリュームには次のいずれかの階層化ポリシーを設定できます。

* * Snapshot のみ *
+
アクティブファイルシステムで現在参照されていないボリュームの Snapshot コピーのみを移動します。「 Snapshot のみ」ポリシーは、デフォルトの階層化ポリシーです。

* * 自動 *
+
アクセス頻度の低いコールドデータと Snapshot コピーをアクティブなファイルシステムからクラウド階層に移動します。

* * バックアップ（ System Manager 9.5 用） *
+
新たに転送されたデータ保護（ DP ）ボリュームのデータをクラウド階層に移動します。

* * すべて（ System Manager 9.6 以降） *
+
すべてのデータをクラウド階層に移動します。

* * なし *
+
クラウド階層へのボリュームのデータの移動が禁止されます。





== アクセス頻度の低いコールドデータとは

高パフォーマンス階層で頻繁にアクセスされないデータは、アクセス頻度の低いコールドデータと呼ばれます。デフォルトでは、 31 日間アクセスされていないデータがアクセス頻度の低いデータとして扱われます。

アクセス頻度の低いデータはアグリゲートレベルとクラスタレベルで表示されます。スキャンが完了したアグリゲートまたはクラスタについてのみ、アクセス頻度の低いデータが表示されます。デフォルトでは、 FabricPool 対応アグリゲートと SSD アグリゲートについてアクセス頻度の低いデータが表示されます。FlexGroup については表示されません。



== クラウド階層ウィンドウに戻ります

System Manager を使用して、クラウド階層を追加、編集、削除したり、詳細を表示したりできます。

クラウド階層ウィンドウには、クラスタ内でライセンスされたクラウド階層の総数、クラスタで使用されているライセンススペース、およびクラスタで使用可能なライセンススペースが表示されます。クラウド階層ウィンドウには、ライセンスのない、使用中のクラウド容量も表示されます。



=== コマンドボタン

* * 追加 * 。
+
クラウド階層を追加できます。

* * アグリゲートを接続 *
+
クラウド階層にアグリゲートを接続できます。

* * 削除 *
+
選択したクラウド階層を削除できます。

* * 編集 * 。
+
選択したクラウド階層のプロパティを変更できます。





=== 詳細領域

クラウド階層のリスト、オブジェクトストアの詳細、使用されているアグリゲート、使用済み容量など、クラウド階層に関する詳細情報を確認できます。

コマンドラインインターフェイス（ CLI ）を使用して Alibaba Cloud 、 Amazon AWS S3 、 AWS Commercial Cloud Service （ C2S ）、 Google Cloud 、 IBM Cloud 、 Microsoft Azure BLOB ストレージ、または StorageGRID 以外のクラウド階層を作成する場合、このクラウド階層は System Manager にその他として表示されます。このクラウド階層にアグリゲートを接続できます。

* 関連情報 *

xref:task_installing_ca_certificate_if_you_use_storagegrid_webscale.adoc[StorageGRID を使用する場合の CA 証明書のインストール]

xref:reference_storage_tiers_window.adoc[ストレージ階層ウィンドウに戻ります]
